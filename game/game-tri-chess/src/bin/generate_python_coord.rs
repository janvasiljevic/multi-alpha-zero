use std::path::Path;
use game_tri_chess::pos::generate_i_to_qrs_mapping;

fn main() {
    let coords = generate_i_to_qrs_mapping();

    let full_path = file!();
    let filename = Path::new(full_path)
        .file_name()
        .unwrap()
        .to_str()
        .unwrap();


    println!("import torch");
    println!("\n# This tensor was generated by {filename}");
    println!("all_hex_coords = torch.tensor([");

    // [list of q, list of r, list of s] -> [[q,r,s], [q,r,s], ...]
    for i in 0..96 {
        let q = coords[0][i];
        let r = coords[1][i];
        let s = coords[2][i];
        println!("    [{}, {}, {}],", q, r, s);
    }

    println!("], dtype=torch.long)\n");

    println!(
        "assert all_hex_coords.shape == (96, 3), f'Expected shape (96, 3), but got {{all_hex_coords.shape}}'"
    );
    println!(
        "assert torch.all(all_hex_coords.sum(dim=1) == -1).item(), 'Verification failed: Not all q+r+s sums equal -1'"
    );
}
